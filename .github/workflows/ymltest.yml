# This is just an example workflow for continuous integration.
# You should customize it to meet your own requirements.
name: 'test-yml'
on:
  # Manually trigger this workflow, and you should pick the right branch.
  workflow_dispatch:
  
jobs:
  setup:
    runs-on: ubuntu-latest
    env:
      M365_USERNAME1: test04@xxbdw.onmicrosoft.com
    outputs:
      cases: ${{ steps.env-a.outputs.cases }}
    steps:

      - name: Checkout dev branch
        uses: actions/checkout@v2
        with:
          ref: main

      - name: Install npm packages
        run: |
          npm install

      - name: set env
        id: env-a
        run: |
          echo "cases=This is cases variable" >> $GITHUB_OUTPUT

      - name: set env2
        run: |
          accounts='${{ secrets.ACCOUNTLIST }}'
          echo "AZURE_ACCOUNT_NAME=$accounts" >> $GITHUB_ENV

      - name: get env
        run: |
          echo env:
          echo "${{ env.AZURE_ACCOUNT_NAME }}"
          accountenv=${{ env.AZURE_ACCOUNT_NAME }}
          echo accountenv0:
          echo ${accountenv[0]}
          echo accountenv1:
          echo ${accountenv[1]}
          accounts=("helly1@hellytest.onmicrosoft.com" "helly2@hellytest.onmicrosoft.com")
          echo ${accounts[0]}
          echo ${accounts[1]}

      - name: echo env
        run: |
          npx ts-node src/a.ts

  main:
    name: main
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: in main
        run: |
          echo main

  report:
    needs: [setup, main]
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Test Environment
        run: |
          echo "This is in double quotation marks"
          echo 'This is in single quotation mark'
          echo This is not in quotation marks
